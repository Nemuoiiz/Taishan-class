<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.css' />
    <title>GSAP</title>

    <style>
        body {
            padding: 20px 0;
        }

        .box1 {
            width: 50px;
            height: 50px;
            margin: 5px;
            background: #000;
        }

        button {
            margin-bottom: 10px;
        }

        h4 {
            margin-top: 24px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h3>tween çš„æ–¹æ³•</h3>
        <p>
            æ“æ§ tween å‹•ç•«æ™‚ï¼Œä½¿ç”¨<b class="bg-danger text-white"> tween çš„æ–¹æ³•</b>ä¾†æ§åˆ¶æˆ–ä¿®æ”¹å‹•ç•«ã€‚
            åƒè€ƒï¼š<a href="https://greensock.com/docs/v3/GSAP/Tween"
                target="_blank">https://greensock.com/docs/v3/GSAP/Tween</a>
        </p>
        <div style="background-color:#eee;">
            <div class="box1"></div>
        </div>

        <div class="row">
            <div class="col">
                <h4>æ§åˆ¶å‹•ç•«çš„æ–¹æ³•</h4>
                <button id="play">play æ­£å‘æ’­æ”¾</button>
                <button id="reverse">reverse åå‘æ’­æ”¾</button>
                <button id="pause">pause æš«åœæ’­æ”¾</button>
                <button id="resume">resume æ¢å¾©æ’­æ”¾</button>
                <button id="restart">restart é‡æ–°æ’­æ”¾</button>
                <button id="seek">seek è·³è‡³æŸå€‹æ™‚é–“é»</button>

                <h4>å»¶é²ã€é‡è¤‡æ–¹æ³•</h4>
                <button id="delay">delay</button>
                <button id="repeat">repeat(1)</button>
                <button id="repeatDelay">repeatDelay</button>

                <h4>é€²åº¦ç›¸é—œæ–¹æ³•</h4>
                <button id="progress">progress èˆ‡ totalProgress</button>
                <button id="time">time èˆ‡ totalTime</button>
                <button id="duration">duration èˆ‡ totalDuration</button>
                <button id="timeScale">timeScale</button>

                <h4>å…¶ä»–æ–¹æ³•</h4>
                <button id="targets">targets èˆ‡ then</button>
                <button id="iteration">iteration</button>
            </div>
            <div class="col">
                <h4>ç‹€æ…‹</h4>
                <p id="paused-text">paused ç‹€æ…‹ï¼ˆå‹•ç•«ç›®å‰æ˜¯å¦æš«åœï¼‰ï¼š</p>
                <p id="reversed-text">reversed ç‹€æ…‹ï¼ˆå‹•ç•«æ˜¯å¦åå‘é€²è¡Œï¼‰ï¼š</p>
                <p id="isActive-text">isActive ç‹€æ…‹ï¼ˆå‹•ç•«æ˜¯å¦é€²è¡Œä¸­ï¼‰ï¼š</p>

                <hr>

                <h4>é€²åº¦</h4>
                <p id="progress-text">progressï¼š</p>
                <p id="totalProgress-text">totalProgressï¼š</p>
                <p id="time-text">timeï¼š</p>
                <p id="totalTime-text">totalTimeï¼š</p>
                <p id="duration-text">durationï¼š</p>
                <p id="totalDuration-text">totalDurationï¼š</p>

                <hr>

                <h4>å…¶ä»–</h4>
                <p id="iteration-text">iterationï¼š</p>
            </div>
        </div>
    </div>


    <!-- jquery -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script>
    <!-- bootstrap -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js'></script>
    <!-- å¼•å…¥ GSAP -->
    <script src="./gsap/gsap.js"></script>

    <script>
        const tweenText = {
            paused: 'paused ç‹€æ…‹ï¼ˆå‹•ç•«æ˜¯å¦æš«åœæ’­æ”¾ï¼‰',
            reversed: 'reversed ç‹€æ…‹ï¼ˆå‹•ç•«æ˜¯å¦åå‘æ’­æ”¾ï¼‰',
            isActive: 'isActive ç‹€æ…‹ï¼ˆå‹•ç•«æ˜¯å¦é€²è¡Œä¸­ï¼‰',
        }

        // = ç‚ºè³¦å€¼ï¼ŒæŒ‡è®Šæ•¸æŒ‡å‘å¾Œé¢çš„è³‡æ–™é¡å‹ (è¨˜æ†¶é«”ä½ç½®)
        const tween = gsap.to('.box1', {
            x: $('.container').width() - $('.box1').width(),
            duration: 5,
            paused: true,
            reversed: false,
            // delay: 2,
            ease: 'none',
            // åœ¨æ›´æ–°æ™‚æ“ä½œ
            onUpdate() {
                // ç‹€æ…‹
                $('#paused-text').text(`${tweenText.paused}:${this.paused()}`)
                $('#reversed-text').text(`${tweenText.reversed}:${this.reversed()}`)
                $('#isActive-text').text(`${tweenText.isActive}:${this.isActive()}`)

                // é€²åº¦ (toFixed => å°æ•¸å¾Œä¸€ä½)
                $('#progress-text').text(`progressï¼š${this.progress().toFixed(1)}`)
                $('#totalProgress-text').text(`totalProgressï¼š${this.totalProgress().toFixed(1)}`)

                // time èˆ‡ totalTime
                $('#time-text').text(`timeï¼š${this.time().toFixed(1)}`)
                $('#totalTime-text').text(`totalTimeï¼š${this.totalTime().toFixed(1)}`)

                // duration èˆ‡ totalDuration
                $('#duration-text').text(`durationï¼š${this.duration().toFixed(1)}`)
                $('#totalDuration-text').text(`totalDurationï¼š${this.totalDuration().toFixed(1)}`)
            },

            onStart() {
                // ç‹€æ…‹
                $('#iteration-text').text(`iterationï¼šæ’­æ”¾ç¬¬ ${this.iteration()} æ¬¡`)
            },

            onRepeat() {
                // ç‹€æ…‹
                $('#iteration-text').text(`iterationï¼šæ’­æ”¾ç¬¬ ${this.iteration()} æ¬¡`)
            },
        })

        // ğŸ”» æ§åˆ¶å‹•ç•«çš„æ–¹æ³• -------------------------------------------------------------

        // 1ï¸âƒ£ æ­£å‘æ’­æ”¾
        $('#play').on('click', function () {
            tween.play()    // ç•¶ä¸‹æ™‚é–“é–‹å§‹æ­£å‘æ’­æ”¾
            // tween.play(3)   // tween.play(ç§’æ•¸) å¯ä»¥å¾æŒ‡å®šç§’æ•¸æ­£å‘æ’­æ”¾
        })

        // 2ï¸âƒ£ åå‘æ’­æ”¾
        $('#reverse').on('click', function () {
            tween.reverse()
            // $('#reversed-text').text(`${tweenText.reversed}:${tween.reversed()}`)
        })

        // 3ï¸âƒ£ æš«åœæ’­æ”¾
        $('#pause').on('click', function () {
            tween.pause()
            // é»æ“Šç•¶ä¸‹æŠ“å– paused çš„ç‹€æ…‹
            $('#paused-text').text(`${tweenText.paused}:${tween.paused()}`)
            $('#reversed-text').text(`${tweenText.reversed}:${tween.reversed()}`)
            $('#isActive-text').text(`${tweenText.isActive}:${tween.isActive()}`)
        })

        // 4ï¸âƒ£ æ¢å¾©æ’­æ”¾
        $('#resume').on('click', function () {
            tween.resume()
        })

        // 5ï¸âƒ£ é‡æ–°æ’­æ”¾
        $('#restart').on('click', function () {
            tween.restart()         // é è¨­ falseï¼Œé‡æ’­æ™‚æœƒç›´æ¥é‡æ–°æ’­æ”¾ï¼Œä¸è€ƒæ…® delay
            tween.restart(true)     // è¨­å®š trueï¼Œé‡æ’­æ™‚æœƒå°‡ delay å»¶é²æ™‚é–“è€ƒæ…®é€²å»
        })

        // 6ï¸âƒ£ è·³è‡³æŸå€‹æ™‚é–“é»
        $('#seek').on('click', function () {
            tween.seek(3)           // ç´”ç²¹è·³åˆ°æŸå€‹æ™‚é–“é»ï¼Œé™¤éæ’­æ”¾é ­ (playhead) å·²ç¶“é–‹å§‹æ’­æ”¾ï¼Œå¦å‰‡ä¸æœƒé€²è¡Œæ’­æ”¾
        })

        // ğŸ”» å»¶é²ã€é‡è¤‡æ–¹æ³• --------------------------------------------------------------

        // 1ï¸âƒ£ å»¶é²æ™‚é–“
        $('#delay').on('click', function () {
            tween.play().delay(3)           // ç”¨ function è¨­å®šåˆå§‹æ’­æ”¾ (æ’­ç¬¬ä¸€æ¬¡) çš„å»¶é²æ™‚é–“ï¼Œé ˆå¯«åœ¨ play çš„å¾Œé¢
            console.log(tween.delay())      // getterï¼Œå»å¾—åˆ° delay çš„ç§’æ•¸
            console.log(tween)
        })

        // 2ï¸âƒ£ é‡è¤‡æ’­æ”¾
        $('#repeat').on('click', function () {
            // é‡æ’­æ˜¯åœ¨åˆå§‹æ’­æ”¾å¾Œçš„æ¬¡æ•¸ï¼Œrepeat(1) æœƒæ’­ 2 æ¬¡ï¼Œ1 æ¬¡æ˜¯åˆå§‹æ’­æ”¾ï¼Œå†ä¾†æ‰æ˜¯é‡è¤‡æ’­æ”¾
            tween.repeat(1).play()          // è¨­å®šé‡è¤‡æ¬¡æ•¸ï¼Œrepeat è·Ÿ play æ”¾å‰æˆ–å¾Œæ²’æœ‰å½±éŸ¿
            console.log(tween.repeat())     // getter å–å‡ºé‡è¤‡æ¬¡æ•¸
            console.log(tween)
            tween.repeat(-1).play()         // -1ï¼Œå¾ªç’°æ’­æ”¾
        })

        // 3ï¸âƒ£ é‡è¤‡æ’­æ”¾çš„å»¶é²æ™‚é–“
        $('#repeatDelay').on('click', function () {
            tween.repeatDelay(2)                // è¨­å®šæ’­æ”¾æ™‚çš„å»¶é²æ™‚é–“ï¼Œæ¯æ¬¡é‡è¦†æ’­æ”¾éƒ½æœƒå…ˆå»¶é² 2 ç§’
            tween.repeat(2).play()              // é‡è¤‡æ’­æ”¾çš„æ¬¡æ•¸
            console.log(tween.repeatDelay())    // getter å–å‡ºé‡è¤‡æ¬¡æ•¸
        })

        // ğŸ”» é€²åº¦ç›¸é—œæ–¹æ³• --------------------------------------------------------------

        // 1ï¸âƒ£ progress èˆ‡ totalProgress
        $('#progress').on('click', function () {
            // tween.progress(0.5) // 0.000000...~ 1.000000ï¼Œè·³åˆ° 0.5 é€²åº¦ä¸€åŠçš„ä½ç½®
            // tween.totalProgress(0.5)

            // åŒ…å«åˆå§‹æ’­æ”¾ 1 æ¬¡ + repeat 1 æ¬¡ï¼Œprogress æœƒè·‘ 2 æ¬¡ï¼ŒtotalProgress åªæœƒè·‘ä¸€æ¬¡ (éç¨‹åŒ…å« repeatDelay æ™‚é–“)
            tween.repeat(1)
            tween.repeatDelay(5)
            tween.play()

            // å–å€¼ getter
            let progressValue = tween.progress()
            let totalProgressValue = tween.totalProgress()
            console.log('progressValueï¼š', progressValue, 'totalProgressValueï¼š', totalProgressValue)
        })

        // 2ï¸âƒ£ time èˆ‡ totalTime
        $('#time').on('click', function () {
            // time æ¯æ¬¡æ’­æ”¾å‹•ç•«æ™‚è€—è²»çš„æ™‚é–“ï¼Œä»¥ duration ç‚ºä¸»
            // totalTime å‹•ç•«å…¨éƒ¨ç¸½èŠ±è²»çš„æ™‚é–“ï¼ŒåŒ…åˆ® repeatDelay
            // ä»¥ä¸‹è·‘å…©æ¬¡å‹•ç•«ï¼Œå› ç‚º duration æ˜¯ 5 ç§’ï¼Œæ‰€ä»¥ time æ¯æ¬¡éƒ½æ˜¯èŠ±è²» 5 ç§’
            // totalTime ç¸½èŠ±è²»æ™‚é–“ = æ’­äº†å…©æ¬¡å‹•ç•«çš„æ™‚é–“ (10ç§’) + repeatDelay 1æ¬¡æ™‚é–“ (5ç§’)
            tween.repeat(1)
            tween.repeatDelay(5)
            tween.play()
        })

        // 3ï¸âƒ£ duration èˆ‡ totalDuration
        $('#duration').on('click', function () {
            tween.duration(3)
            tween.repeat(2)
            tween.repeatDelay(2)
            tween.play()

            // duration åˆå§‹æ’­æ”¾ã€repeat æ’¥æ”¾å‹•ç•«æŒçºŒæ™‚é–“çš„ä¾æ“šï¼Œç¯„ä¾‹ duration 3 ç§’
            // totalDuration æ˜¯ repeatDelayã€repeat æ¬¡æ•¸çš„åŠ ç¸½
            // totalDuration = duration + repeat(æ¬¡æ•¸) * (duration + repeatDelays)
            // 3 + 2 * (3 + 2) = 13
        })

        // ğŸ”» å…¶ä»–æ–¹æ³• --------------------------------------------------------------

        // 1ï¸âƒ£ targets èˆ‡ then
        $('#targets').on('click', function () {
            // tween.targets() åƒèˆ‡å‹•ç•«çš„å…ƒç´ 
            console.log(tween.targets())
            tween.play()

            tween
                .then(function (tween) {
                    $(tween.targets()).css({ background: 'blue' })
                    return tween
                })
                .then(function (tween) {
                    setTimeout(() => {
                        gsap.to('.box1', {
                            backgroundColor: 'red',
                            rotation: 360,
                        })
                    }, 1000)
                })
        })

        // iteration æŠ“å–å¼Ÿå¹¾æ¬¡æ’­æ”¾
        $('#iteration').on('click', function () {
            console.log(tween.iteration())  // getter æ²’æœ‰è¨­å®šï¼ŒæŠ“å–ç¬¬å¹¾æ¬¡
            tween.play()
            tween.repeat(2)
            tween.iteration(2).play()   // setter è¨­å®šå¾ç¬¬äºŒæ¬¡é–‹å§‹æ’­æ”¾
            // console.log(tween.iteration())
        })
    </script>
</body>

</html>