<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.css' />
    <title>GSAP</title>

    <style>
        section {
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        section:nth-child(odd) {
            background: antiquewhite;
        }

        section:nth-child(even) {
            background: linen;
            justify-content: center;
        }

        section h2 {
            position: absolute;
            left: 0;
            top: 0;
        }

        .box {
            width: 100px;
            height: 100px;
            color: white;
            font-size: 2rem;
            background: thistle;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: 0.5s;
        }

        .active {
            background: tomato;
        }

        .hello {
            background: orange;
        }

        .main {
            position: relative;
            z-index: 1;
        }

        .follower {
            background: orange;
            position: absolute;
        }
    </style>
</head>

<body>
    <section></section>

    <section id="section01">
        <h2>1. è¨­å®š triggerã€start èˆ‡ end</h2>
        <div class="box a1">a1</div>
    </section>

    <section></section>

    <section id="section02">
        <h2>2. è¨­å®š toggleActions</h2>
        <div class="box b1">b1</div>
        <div class="box b2 mt-5">b2</div>
        <div class="box b2 mt-5">b2</div>
    </section>

    <section></section>

    <section id="section03">
        <h2>3. è¨­å®š scrub</h2>
        <div class="box c1">c1</div>
    </section>

    <section></section>

    <section id="section04">
        <h2>4. è·Ÿéš¨</h2>
        <div class="box main">main</div>
        <div class="box follower">follower</div>
    </section>

    <section></section>

    <section id="section05">
        <h2>5. timeline èˆ‡ scrollTrigger</h2>
        <div class="box d1">d1</div>
    </section>

    <section></section>


    <!-- jquery -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script>
    <!-- bootstrap -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js'></script>

    <!-- 1. å¼•å…¥ GSAP -->
    <!-- <script src="./gsap/gsap.js"></script> -->
    <script src="./gsap/gsap_old.js"></script>

    <!-- 2. å¼•å…¥ plugin æ”¯æ´å¥—ä»¶ ScrollTrigger -->
    <!-- <script src="./gsap/ScrollTrigger.js"></script> -->
    <script src="./gsap/ScrollTrigger_old.js"></script>

    <script>
        // ğŸ”—ï¼šhttps://gsap.com/docs/v3/Plugins/ScrollTrigger

        // 3. è¨»å†Šå¥—ä»¶
        gsap.registerPlugin(ScrollTrigger)


        // 1ï¸âƒ£ è¨­å®š triggerã€start èˆ‡ end --------------------------------------

        const tween1 = gsap.to('.a1', {
            scrollTrigger: {
                trigger: '.a1',         // è§¸ç™¼å°è±¡
                /*
                    ğŸ”»start èˆ‡ end è¨­å®š
                    é›™æ•¸å€¼
                    1. ç¬¬ä¸€æ•¸å€¼ç‚º trigger(å…ƒç´ ) çš„ä½ç½®ï¼Œç¬¬äºŒæ•¸å€¼ç‚ºæ»¾å‹•è»¸çš„ä½ç½®
                    2. å€¼å¯ç‚º topã€centerã€bottomã€pxã€%ã€ç›¸å°ä½ç½®(+=100ã€-=100)ã€å‡½å¼è¿”å›å€¼

                    è§¸ç™¼æ™‚æ©Ÿ
                    1. ç•¶æ»¾å‹•è»¸ scroller-start èˆ‡ trigger çš„ start ç›¸äº¤æ™‚ (ç¶ ç¢°ç¶ )ï¼Œå‹•ç•«é–‹å§‹
                    2. ç•¶æ»¾å‹•è»¸ scroller-end   èˆ‡ trigger çš„ end ç›¸äº¤æ™‚ (ç´…ç¢°ç´…)ï¼Œå‹•ç•«çµæŸ
                */
                start: 'top center',    // 'å…ƒç´  æ²å‹•è»¸'
                end: 'bottom top',      // 'å…ƒç´  æ²å‹•è»¸'

                // ç™¾åˆ†æ¯”
                start: 'top 50%',
                end: 'bottom 50%',

                // ç›¸å°ä½ç½®ï¼Œ +=100 ç¾åœ¨çš„ä½ç½®å¾€ä¸‹ç§»å‹• 100
                start: '+=100 50%',
                end: 'bottom 50%',

                // å‡½å¼è¿”å›å€¼
                start: 'center center',
                end: () => `+=${$('.a1').height()}`,

                // markers: true,          // æ‰“é–‹ç´…è‰²ç¶ è‰²åµæ¸¬ä½ç½®çš„ç·š
            },

            x: '85vw',
            duration: 3,
            ease: 'none',
        })


        // 2ï¸âƒ£ è¨­å®š toggleActions --------------------------------------

        const tween2 = gsap.to('.b1', {
            scrollTrigger: {
                trigger: '.b1',
                start: 'top center',
                end: 'bottom 20%',
                // ğŸ”»toggleActions
                // é è¨­ play none none none
                /*
                    onEnterï¼šç¬¬ä¸€å€‹åƒæ•¸æŒ‡ scroller-start èˆ‡ trigger çš„ start ç›¸äº¤æ™‚ï¼Œ(æ²å‹•è»¸å¾€ä¸‹ç¶ ç¢°ç¶ ) è§¸ç™¼å‹•ç•«å‹•ä½œ
                    onLeaveï¼šç¬¬äºŒå€‹åƒæ•¸æŒ‡ scroller-end èˆ‡ trigger çš„ end ç›¸äº¤æ™‚ï¼Œ(æ²å‹•è»¸å¾€ä¸‹ç´…ç¢°ç´…) è§¸ç™¼å‹•ç•«å‹•ä½œ
                    onEnterBackï¼šç¬¬ä¸‰å€‹åƒæ•¸æŒ‡ sroller-end è¿”å›ã€è§¸ç™¼ trigger-end æ™‚ (æ²å‹•è»¸å¾€ä¸Šç´…ç¢°ç´…) è§¸ç™¼å‹•ç•«å‹•ä½œ
                    onLeaveBackï¼šç¬¬å››å€‹åƒæ•¸æŒ‡ sroller-end è¿”å›ã€è§¸ç™¼ trigger-end æ™‚ (æ²å‹•è»¸å¾€ä¸Šç¶ ç¢°ç¶ ) è§¸ç™¼å‹•ç•«å‹•ä½œ

                    å‹•ä½œçš„å€¼å¯ä»¥ç‚ºï¼š
                    playã€pauseã€resumeã€reverseã€restartã€resetã€completeã€none
                */
                toggleActions: 'play pause resume restart',

                // è§¸ç™¼å‹•ç•«æ™‚åŠ ä¸Š class
                // toggleClass: 'active',

                // å°å¤šå€‹å…ƒç´ åŠ ä¸Š class
                toggleClass: {
                    targets: ['.b1', '.b2'],
                    className: 'active',
                },
                onEnterBack() {
                    $('.b2').addClass('hello')
                },
                onLeaveBack() {
                    $('.b2').removeClass('hello')
                },

                // markers: true,
            },
            x: '85vw',
            duration: 3,
            ease: 'none',
        })


        // 3ï¸âƒ£ è¨­å®š scrub -------------------------------------------

        const tween3 = gsap.to('.c1', {
            scrollTrigger: {
                trigger: '.c1',
                start: 'top 60%',
                end: 'bottom 40%',
                // markers: true,

                /* 
                    ğŸ”»scrub
                    æœƒåœ¨ ScrollTrigger è™•æ–¼æ´»å‹•ç‹€æ…‹æ™‚
                    (ç•¶ scroller-start èˆ‡ start ç›¸äº¤æ™‚ï¼Œä»¥åŠç•¶ scroller-end èˆ‡ end ç›¸äº¤ä¹‹é–“è·é›¢ç¯„åœå…§)
                    å‹•ç•«é€²åº¦æœƒé€£çµåˆ°æ»¾å‹•æ¢çš„é€²åº¦ï¼Œ
                    åœ¨é€™ç¯„åœå…§æ»¾å‹•æ¢ä¸Šä¸‹ç§»å‹•ï¼Œå¯ä»¥å‘æ»‘å¡Šæ§åˆ¶å…ƒç´ å‹•ç•«çš„å®šåº¦
                */
                scrub: true,
                scrub: 3,   // å€¼è¨­å®š 3ï¼Œæœƒåœ¨ 3 ç§’å¾Œè·Ÿä¸Šæ»¾å‹•è»¸çš„é€²åº¦
            },
            x: '85vw',
            // duration: 3,    // æ­é… scrub æ™‚ï¼Œè£œé–“å‹•ç•«(tween)çš„ duration æ²’æœ‰ä½œç”¨
            backgroundColor: 'red',
            rotation: 3600,
            ease: 'none',
        })

        // 4ï¸âƒ£ è·Ÿéš¨ -------------------------------------------

        gsap.to('.main', {
            scrollTrigger: {
                trigger: '.main',
                start: 'top 80%',
                end: 'top 20%',
                scrub: true,
                markers: true,
            },
            x: '85vw',
            rotation: 720,
        })

        gsap.to('.follower', {
            scrollTrigger: {
                trigger: '.main',
                start: 'top 80%',
                end: 'top 20%',
                scrub: 3,
                // markers: true,
            },
            x: '85vw',
            rotation: 720,
        })

        // 5ï¸âƒ£ timeline èˆ‡ scrollTrigger -------------------------------------------
        // ç•¶æ™‚é–“è»¸è¨­å®š ScrollTrigger æ™‚ï¼Œå¯ä»¥æ§åˆ¶æ•´å€‹æ™‚é–“è»¸çš„é€²åº¦
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.d1',
                start: 'center 80%',
                end: 'center 20%',
                scrub: 1,
                markers: true,
            }
        })

        /*
            ç•¶ timeline èˆ‡ scrollTrigger ç¶åœ¨ä¸€èµ·æ™‚ï¼Œ
            æ™‚é–“è»¸è£¡é¢çš„è£œé–“å‹•ç•« duration æœƒèˆ‡ scrollerTrigger çš„æ²å‹•è»¸ç¯„åœæˆæ¯”ä¾‹
            ä¾‹å¦‚ä»¥ä¸‹ duration ç¸½å…±æ˜¯ 3ï¼Œæ¯ä¸€çµ„è£œé–“å‹•ç•«éƒ½æœƒä½” 1/3 çš„æ²å‹•ç¯„åœ
            1ã€1ã€1 é€²åº¦æœƒè¢«åˆ†æˆ 33.3% 33.3% 33.3%
            1ã€2ã€3 é€²åº¦æœƒè¢«åˆ†æˆ 1/6ã€2/6ã€3/6 
        */
        tl
            .to('.d1', {
                x: '85vw',
                duration: 1
            })
            .to('.d1', {
                rotation: 360,
                background: 'red',
                duration: 2,
            })
            .to('.d1', {
                x: 0,
                background: 'blue',
                duration: 3,
            })

    </script>
</body>

</html>