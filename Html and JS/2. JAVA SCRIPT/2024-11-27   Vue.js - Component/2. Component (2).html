<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css'
        integrity='sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg=='
        crossorigin='anonymous' />
</head>

<body>
    <div id="app">
        <div class="container">
            <div class="row">
                <div class="col-4">
                    <!--
                    ðŸ”» ç”¨æ¨™ç±¤å±¬æ€§æŠŠè³‡æ–™å‚³å…¥å…ƒä»¶ props
                    price="1000" => æ–‡å­—
                    price=1000   => æ•¸å­—
                    sell         => å¸ƒæž—å€¼ (å¸ƒæž—å€¼æœ‰å¯«å°±æ˜¯ trueï¼Œæ²’å¯«å°±æ˜¯ false)
                    -->
                    <Card :price="1000" sell image="https://github.com/vuejs.png" title="Vue" text="Vue.js"></Card>
                </div>
            </div>

            <hr>

            <div class="row">
                <!-- æ¼²åƒ¹æŒ‰éˆ• -->
                <input type="button" value="æ¼²åƒ¹" class="btn btn-primary" @click="changePrice">

                <div class="col-3" v-for="product in products">
                    <!-- <Card :price="product.price" :sell="product.sell" :image="product.image" :title="product.title"
                    :text="product.text"></Card> -->
                    <!-- ðŸ”º  product ç‰©ä»¶çš„å±¬æ€§åç¨±èˆ‡å­çµ„ä»¶ props åç¨±ä¸€è‡´æ™‚å¯ç°¡å¯« ðŸ”» -->
                    <Card v-bind="product"></Card>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- ðŸ” æŒ‡å‘ id åç‚º card çš„æ¨¡æ¿ (åˆ‡è¨˜ä¸èƒ½ç”¨ src) -->
    <script type="text/x-template" id="card">

        <div class="card">
            <!-- è£½ä½œä¸€å€‹ card å…ƒä»¶çš„ html -->
            <img :src="image" class="card-img-top">
            <div class="card-body">
                <h5 class="card-title">{{ title }}</h5>
                <h6 class="card-subtitle text-body-secondary">{{ price }}</h6>
                <h6 v-if="!sell" class="text-danger">å·²ä¸‹æž¶</h6>
                <p class="card-text">{{ text }}</p>
                <input type="button" class="btn btn-primary" value="è©³ç´°" @click="info">
            </div>

        </div>
        
    </script>

    <script>
        // toRefã€toRefs => ç‚ºç¶­æŒéŸ¿æ‡‰æ€§è€Œæ–°å¢ž
        const { createApp, reactive, toRef, toRefs } = Vue

        createApp({
            setup() {
                const products = reactive([
                    { price: 1000, sell: true, image: 'https://github.com/twbs.png', title: 'Bootstrap', text: 'bsbs' },
                    { price: 2000, sell: false, image: 'https://github.com/wdaweb.png', title: 'Wdaweb', text: 'wdawda' }
                ])

                // æ¼²åƒ¹
                const changePrice = () => {
                    for (const product of products) {
                        product.price *= 2
                    }
                }

                // ðŸ”» è¨˜å¾— return
                return { products, changePrice }
            }
        })
            .component('Card', {
                setup(props) {
                    // ðŸ”»ç›´æŽ¥è§£æ§‹ props æœƒå¤±åŽ»éŸ¿æ‡‰æ€§
                    const { price } = props
                    // ðŸ”»è§£æ§‹ props ç¶­æŒéŸ¿æ‡‰æ€§ï¼Œå¯å†åŠ ä¸Šä¸‹é¢å…©è¡Œ
                    const { price: priceRefs } = toRefs(props)      // æ–¹æ³•1ï¸âƒ£
                    const priceRef = toRef(props, 'price')          // æ–¹æ³•2ï¸âƒ£

                    const info = () => {
                        console.log('props.price', props.price)
                        console.log('price', price)                 // å¤±åŽ»éŸ¿æ‡‰æ€§ï¼Œ'è©³ç´°æŒ‰éˆ•'åƒ¹æ ¼ä¸æ­£ç¢º

                        console.log('priceRefs', priceRefs.value)   // ç¶­æŒéŸ¿æ‡‰æ€§
                        console.log('priceRef', priceRef.value)     // ç¶­æŒéŸ¿æ‡‰æ€§
                    }

                    return { info }
                },
                // methods: {
                //     info() {
                //         // é¸é …å¼ç”¨ this.prop åç¨±
                //         console.log(this.price)
                //     }
                // },

                // ðŸ” æŒ‡å‘ id åç‚º card çš„æ¨¡æ¿
                template: '#card',

                // âœ… props å¾ˆé‡è¦ä¸€å®šè¦æ‡‚ï¼Œæ‰çœ‹å¾—æ‡‚åˆ¥äººå…ƒä»¶æœ‰å“ªäº›
                // ðŸ”» props å®šç¾©å…ƒä»¶æŽ¥æ”¶å“ªäº›è³‡æ–™
                // å·æ‡¶çš„å¯«æ³• => ä½¿ç”¨ [] å°‡å…ƒä»¶è³‡æ–™éƒ½åŒ…èµ·ä¾†
                // props: ['image', 'title', 'text', 'sell', 'price']
                // æ­£å¸¸çš„å¯«æ³•
                props: {
                    // æŒ‡å®šè³‡æ–™çš„åž‹æ…‹
                    // ä¸ç¬¦åˆä¸æœƒæŽ›æŽ‰ï¼Œä½†æœƒæ”¶åˆ°è­¦å‘Š (è³‡æ–™åž‹æ…‹ä¸ç¬¦åˆ)
                    price: Number,
                    sell: Boolean,
                    image: {
                        type: String
                    },
                    text: {
                        // æŒ‡å®šè³‡æ–™åž‹æ…‹ï¼Œä¸”ä¸€å®šè¦çµ¦è³‡æ–™
                        type: String,                   // è³‡æ–™åž‹æ…‹
                        required: true,                 // è¨­å®šç‚ºå¿…å¡«
                    },
                    title: {
                        // æŒ‡å®šè³‡æ–™åž‹æ…‹ã€é è¨­å€¼ã€é©—è­‰
                        type: String,                   // è³‡æ–™åž‹æ…‹
                        default() {                     // é è¨­å€¼
                            return 'å•†å“æ¨™é¡Œ'
                        },
                        validator(value) {              // é©—è­‰
                            return value.length >= 3
                        }
                    }
                }
            })
            .mount('#app')
    </script>
</body>

</html>